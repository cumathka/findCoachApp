{"remainingRequest":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/node_modules/babel-loader/lib/index.js!/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/node_modules/eslint-loader/index.js??ref--14-0!/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/src/store/modules/auth/actions.js","dependencies":[{"path":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/src/store/modules/auth/actions.js","mtime":1716451011411},{"path":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/babel.config.js","mtime":1598433744000},{"path":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/node_modules/cache-loader/dist/cjs.js","mtime":1715786782995},{"path":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/node_modules/babel-loader/lib/index.js","mtime":1715786783256},{"path":"/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/node_modules/eslint-loader/index.js","mtime":1715786783035}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwpsZXQgdGltZXI7CmV4cG9ydCBkZWZhdWx0IHsKICBhc3luYyBsb2dpbihjb250ZXh0LCBwYXlsb2FkKSB7CiAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgnYXV0aCcsIHsKICAgICAgLi4ucGF5bG9hZCwKICAgICAgbW9kZTogJ2xvZ2luJwogICAgfSk7CiAgfSwKICBhc3luYyBzaWdudXAoY29udGV4dCwgcGF5bG9hZCkgewogICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goJ2F1dGgnLCB7CiAgICAgIC4uLnBheWxvYWQsCiAgICAgIG1vZGU6ICdzaWdudXAnCiAgICB9KTsKICB9LAogIGFzeW5jIGF1dGgoY29udGV4dCwgcGF5bG9hZCkgewogICAgY29uc3QgbW9kZSA9IHBheWxvYWQubW9kZTsKICAgIGxldCB1cmwgPSAnaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vdjEvYWNjb3VudHM6c2lnbkluV2l0aFBhc3N3b3JkP2tleT1BSXphU3lEc1dIY0FzM2lhUFM4MkJfT21CRzMtRnJpUU42U05YZG8nOwogICAgaWYgKG1vZGUgPT09ICdzaWdudXAnKSB7CiAgICAgIHVybCA9ICdodHRwczovL2lkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbS92MS9hY2NvdW50czpzaWduVXA/a2V5PUFJemFTeURzV0hjQXMzaWFQUzgyQl9PbUJHMy1GcmlRTjZTTlhkbyc7CiAgICB9CiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgaGVhZGVyczogewogICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgfSwKICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgIGVtYWlsOiBwYXlsb2FkLmVtYWlsLAogICAgICAgIHBhc3N3b3JkOiBwYXlsb2FkLnBhc3N3b3JkLAogICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlCiAgICAgIH0pCiAgICB9KTsKICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgdmFyIF9yZXNwb25zZURhdGEkZXJyb3I7CiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCgoX3Jlc3BvbnNlRGF0YSRlcnJvciA9IHJlc3BvbnNlRGF0YS5lcnJvcikgPT09IG51bGwgfHwgX3Jlc3BvbnNlRGF0YSRlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Jlc3BvbnNlRGF0YSRlcnJvci5tZXNzYWdlKSB8fCAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCEgQ2hlY2sgeW91ciBkYXRhIScpOwogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICAgIGNvbnN0IGV4cGlyZXNJbiA9ICtyZXNwb25zZURhdGEuZXhwaXJlc0luICogMTAwMDsKICAgIGNvbnN0IGV4cGlyYXRpb25EYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKyBleHBpcmVzSW47CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCByZXNwb25zZURhdGEuaWRUb2tlbik7CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcklkJywgcmVzcG9uc2VEYXRhLmxvY2FsSWQpOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2V4cGlyYXRpb25EYXRlJywgZXhwaXJhdGlvbkRhdGUpOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2VtYWlsJywgcmVzcG9uc2VEYXRhLmVtYWlsKTsKICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnRleHQuZGlzcGF0Y2goJ2F1dG9Mb2dvdXQnKTsKICAgIH0sIGV4cGlyZXNJbik7CiAgICBjb250ZXh0LmNvbW1pdCgnc2V0VXNlcicsIHsKICAgICAgdG9rZW46IHJlc3BvbnNlRGF0YS5pZFRva2VuLAogICAgICB1c2VySWQ6IHJlc3BvbnNlRGF0YS5sb2NhbElkLAogICAgICBlbWFpbDogcGF5bG9hZC5lbWFpbAogICAgfSk7CiAgfSwKICB0cnlMb2dpbihjb250ZXh0KSB7CiAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgY29uc3QgdXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpOwogICAgY29uc3QgdG9rZW5FeHBpcmF0aW9uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuRXhwaXJhdGlvbicpOwogICAgY29uc3QgZXhwaXJlc0luID0gK3Rva2VuRXhwaXJhdGlvbiAtIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgaWYgKGV4cGlyZXNJbiA8IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgY29udGV4dC5kaXNwYXRjaCgnYXV0b0xvZ291dCcpOwogICAgfSwgZXhwaXJlc0luKTsKICAgIGlmICh0b2tlbiAmJiB1c2VySWQpIHsKICAgICAgY29udGV4dC5jb21taXQoJ3NldFVzZXInLCB7CiAgICAgICAgdG9rZW46IHRva2VuLAogICAgICAgIHVzZXJJZDogdXNlcklkLAogICAgICAgIHRva2VuRXhwaXJhdGlvbjogbnVsbCwKICAgICAgICBlbWFpbDogbnVsbAogICAgICB9KTsKICAgIH0KICB9LAogIGxvZ291dChjb250ZXh0KSB7CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcklkJyk7CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbkV4cGlyYXRpb24nKTsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdlbWFpbCcpOwogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2V4cGlyYXRpb25EYXRlJyk7CiAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgY29udGV4dC5jb21taXQoJ3NldFVzZXInLCB7CiAgICAgIHRva2VuOiBudWxsLAogICAgICB1c2VySWQ6IG51bGwsCiAgICAgIGVtYWlsOiBudWxsCiAgICB9KTsKICB9LAogIGF1dG9Mb2dvdXQoY29udGV4dCkgewogICAgY29udGV4dC5kaXNwYXRjaCgnbG9nb3V0Jyk7CiAgICBjb250ZXh0LmNvbW1pdCgnc2V0QXV0b0xvZ291dCcpOwogIH0KfTs="},{"version":3,"names":["timer","login","context","payload","dispatch","mode","signup","auth","url","response","fetch","method","headers","body","JSON","stringify","email","password","returnSecureToken","responseData","json","ok","_responseData$error","error","Error","message","expiresIn","expirationDate","Date","getTime","localStorage","setItem","idToken","localId","setTimeout","commit","token","userId","tryLogin","getItem","tokenExpiration","logout","removeItem","clearTimeout","autoLogout"],"sources":["/Users/cumakaya/Desktop/Vue.js_Advance/main-prj-01-starting-setup/src/store/modules/auth/actions.js"],"sourcesContent":["let timer;\nexport default {\n  async login(context, payload) {\n    return context.dispatch('auth', {\n      ...payload,\n      mode: 'login',\n    });\n  },\n  async signup(context, payload) {\n    return context.dispatch('auth', {\n      ...payload,\n      mode: 'signup',\n    });\n  },\n  async auth(context, payload) {\n    const mode = payload.mode;\n    let url =\n      'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDsWHcAs3iaPS82B_OmBG3-FriQN6SNXdo';\n\n    if (mode === 'signup') {\n      url =\n        'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDsWHcAs3iaPS82B_OmBG3-FriQN6SNXdo';\n    }\n\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email: payload.email,\n        password: payload.password,\n        returnSecureToken: true,\n      }),\n    });\n\n    const responseData = await response.json();\n\n    if (!response.ok) {\n      const error = new Error(\n        responseData.error?.message ||\n          'An unknown error occurred! Check your data!'\n      );\n      throw error;\n    }\n\n    const expiresIn = +responseData.expiresIn * 1000;\n    const expirationDate = new Date().getTime() + expiresIn;\n\n    localStorage.setItem('token', responseData.idToken);\n    localStorage.setItem('userId', responseData.localId);\n    localStorage.setItem('expirationDate', expirationDate);\n    localStorage.setItem('email', responseData.email);\n\n    timer = setTimeout(function () {\n      context.dispatch('autoLogout');\n    }, expiresIn);\n\n    context.commit('setUser', {\n      token: responseData.idToken,\n      userId: responseData.localId,\n      email: payload.email,\n    });\n  },\n\n  tryLogin(context) {\n    const token = localStorage.getItem('token');\n    const userId = localStorage.getItem('userId');\n    const tokenExpiration = localStorage.getItem('tokenExpiration');\n\n    const expiresIn = +tokenExpiration - new Date().getTime(); \n\n    if (expiresIn < 0) {\n      return\n    }\n\n    timer = setTimeout(function(){\n      context.dispatch('autoLogout')\n    },expiresIn)\n\n    if (token && userId) {\n      context.commit('setUser', {\n        token: token,\n        userId: userId,\n        tokenExpiration: null,\n        email: null,\n      });\n    }\n  },\n\n  logout(context) {\n    localStorage.removeItem('userId');\n    localStorage.removeItem('token');\n    localStorage.removeItem('tokenExpiration');\n    localStorage.removeItem('email');\n    localStorage.removeItem('expirationDate');\n\n    clearTimeout(timer);\n\n    context.commit('setUser', {\n      token: null,\n      userId: null,\n      email: null,\n    });\n  },\n\n  autoLogout(context){\n   context.dispatch('logout');\n   context.commit('setAutoLogout');\n  }\n};\n"],"mappings":"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","ignoreList":[]}]}